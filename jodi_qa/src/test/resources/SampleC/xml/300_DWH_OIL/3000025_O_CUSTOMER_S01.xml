<?xml version="1.0" encoding="UTF-8"?>
<Transformation
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../../../../../jodi_core/src/main/resources/jodi-model.v1.1.xsd">
    <Comments></Comments>
    <PackageList>PACKAGE_ALL</PackageList>
    <Datasets>
        <Dataset>
            <Source>
                <Name>CHIN_INVOICE</Name>
            </Source>
        </Dataset>
    </Datasets>
    <Mappings>
        <TargetDataStore>O_CUSTOMER_S01</TargetDataStore>
        <TargetColumn>
            <Name>INVOICE_CODE</Name>
            <MappingExpressions>
                <Expression>CHIN_INVOICE.INVOICE_CODE</Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>61</Length>
            </Properties>
        </TargetColumn>
        <TargetColumn>
            <Name>CUSTOMER_CODE</Name>
            <MappingExpressions>
                <Expression>CHIN_INVOICE.CUSTOMER_CODE</Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>60</Length>
            </Properties>
        </TargetColumn>
        <TargetColumn>
            <Name>BILLING_ADDRESS</Name>
            <MappingExpressions>
                <Expression>CHIN_INVOICE.BILLINGADDRESS</Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>70</Length>
                <Scale>0
                </Scale><!-- due to default in odi the scale is set to 50 although it is not applicable for varchar2 -->
            </Properties>
        </TargetColumn>
        <TargetColumn>
            <Name>BILLING_CITY</Name>
            <MappingExpressions>
                <Expression>CHIN_INVOICE.BILLINGCITY</Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>40</Length>
            </Properties>
        </TargetColumn>
        <TargetColumn>
            <Name>BILLING_STATE</Name>
            <MappingExpressions>
                <Expression>CHIN_INVOICE.BILLINGSTATE</Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>40</Length>
            </Properties>
        </TargetColumn>
        <TargetColumn>
            <Name>BILLING_COUNTRY</Name>
            <MappingExpressions>
                <Expression>CHIN_INVOICE.BILLINGCOUNTRY</Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>40</Length>
            </Properties>
        </TargetColumn>
        <TargetColumn>
            <Name>BILLING_POSTALCODE</Name>
            <MappingExpressions>
                <Expression>CHIN_INVOICE.BILLINGPOSTALCODE</Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>10</Length>
            </Properties>
        </TargetColumn>
        <TargetColumn>
            <Name>LAST_INVOICE_CODE_CUSTOMER</Name>
            <MappingExpressions>
                <Expression>FIRST_VALUE(CHIN_INVOICE.INVOICE_CODE) OVER (PARTITION BY CHIN_INVOICE.CUSTOMER_CODE ORDER
                    BY CHIN_INVOICE.INVOICEDATE DESC)
                </Expression>
            </MappingExpressions>
            <Properties>
                <DataType>VARCHAR2</DataType>
                <Length>61</Length>
            </Properties>
        </TargetColumn>
    </Mappings>
</Transformation>